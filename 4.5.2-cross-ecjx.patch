--- origsrc/gcc-4.5.2/libjava/Makefile.am	2010-07-15 07:05:56.000000000 -0500
+++ src/gcc-4.5.2/libjava/Makefile.am	2011-01-11 16:17:07.828828300 -0600
@@ -1124,10 +1124,17 @@ endif
 else !NATIVE
 
 ecjx_LINK = $(GCJ_FOR_ECJX_LINK) $(ecjx_LDFLAGS)
+if INSTALL_ECJ_JAR
 ecjx_LDFLAGS = $(ECJX_BASE_FLAGS) $(ECJ_BUILD_JAR)
+else
+ecjx_LDFLAGS = $(ECJX_BASE_FLAGS) -Djava.class.path=$(ECJ_JAR)
+endif
 ecjx_LDADD = 
 ecjx_DEPENDENCIES = 
 
+ecjx.$(OBJEXT): ecjx.cc
+	$(GCJ_FOR_ECJX) -c -o $@ $<
+
 endif !NATIVE
 
 ## This is a dummy definition.
--- origsrc/gcc-4.5.2/libjava/Makefile.in	2010-12-16 06:49:03.000000000 -0600
+++ src/gcc-4.5.2/libjava/Makefile.in	2011-01-11 16:18:06.282130200 -0600
@@ -8515,7 +8515,8 @@ ECJX_BASE_FLAGS = -findirect-dispatch \
 @NATIVE_TRUE@ecjx_LINK = $(GCJLINK) $(ecjx_LDFLAGS)
 @ENABLE_SHARED_FALSE@@NATIVE_TRUE@ecjx_LDFLAGS = $(ECJX_BASE_FLAGS) $(ECJ_BUILD_JAR) -fbootclasspath=$(BOOTCLASSPATH)
 @ENABLE_SHARED_TRUE@@NATIVE_TRUE@ecjx_LDFLAGS = $(ECJX_BASE_FLAGS) -Djava.class.path=$(ECJ_JAR)
-@NATIVE_FALSE@ecjx_LDFLAGS = $(ECJX_BASE_FLAGS) $(ECJ_BUILD_JAR)
+@INSTALL_ECJ_JAR_FALSE@@NATIVE_FALSE@ecjx_LDFLAGS = $(ECJX_BASE_FLAGS) -Djava.class.path=$(ECJ_JAR)
+@INSTALL_ECJ_JAR_TRUE@@NATIVE_FALSE@ecjx_LDFLAGS = $(ECJX_BASE_FLAGS) $(ECJ_BUILD_JAR)
 @NATIVE_FALSE@ecjx_LDADD = 
 @NATIVE_TRUE@ecjx_LDADD = -L$(here)/.libs $(extra_ldflags) \
 @NATIVE_TRUE@	$(am__append_31)
@@ -12888,6 +12889,9 @@ write-entries-to-file-check:
 @MAINTAINER_MODE_TRUE@@NATIVE_TRUE@	>> tmp-0212; \
 @MAINTAINER_MODE_TRUE@@NATIVE_TRUE@	mv tmp-0212 $(srcdir)/gnu/gcj/convert/JIS0212.h
 
+@NATIVE_FALSE@ecjx.$(OBJEXT): ecjx.cc
+@NATIVE_FALSE@	$(GCJ_FOR_ECJX) -c -o $@ $<
+
 src.zip:
 	-rm -f src.zip
 	here=`pwd`; \
